<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chase the Dream</title>
  <style>
    body {
      background: #000;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
      margin-top: 20px;
    }
    canvas {
      background: #111;
      margin-top: 20px;
    }
    #status {
      margin-top: 10px;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <h1>üèÉ Chase the Dream</h1>
  <canvas id="game" width="400" height="400"></canvas>
  <div id="status">Health: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è | Score: 0</div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const box = 40;
    const rows = canvas.height / box;
    const cols = canvas.width / box;

    let player = {
      x: 0, y: 0,
      pixelX: 0, pixelY: 0,
      targetX: 0, targetY: 0,
      moving: false
    };
    let health = 3;
    let score = 0;

    const items = [];

    const drawRect = (x, y, color, symbol, isPixel = false) => {
      const drawX = isPixel ? x : x * box;
      const drawY = isPixel ? y : y * box;
      ctx.fillStyle = color;
      ctx.fillRect(drawX, drawY, box - 2, box - 2);
      ctx.fillStyle = "#fff";
      ctx.font = "20px sans-serif";
      ctx.fillText(symbol, drawX + 10, drawY + 28);
    };

    const spawnItems = () => {
      const types = ['dream', 'temptation', 'work'];
      for (let i = 0; i < 5; i++) {
        let x = Math.floor(Math.random() * cols);
        let y = Math.floor(Math.random() * rows);
        if (x === player.x && y === player.y) continue;
        let type = types[Math.floor(Math.random() * types.length)];
        items.push({ x, y, type });
      }
    };

    const update = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // Draw player at pixel position
      drawRect(player.pixelX, player.pixelY, 'white', 'üßç', true);

      for (let item of items) {
        let color, symbol;
        if (item.type === 'dream') {
          color = 'gold'; symbol = 'üèÜ';
        } else if (item.type === 'temptation') {
          color = 'red'; symbol = 'üçî';
        } else {
          color = 'blue'; symbol = 'üíº';
        }
        drawRect(item.x, item.y, color, symbol);
      }

      document.getElementById("status").innerText = `Health: ${'‚ù§Ô∏è'.repeat(health)} | Score: ${score}`;
    };

    function animatePlayer() {
      if (!player.moving) return;
      const speed = 8; // pixels per frame
      let dx = player.targetX - player.pixelX;
      let dy = player.targetY - player.pixelY;
      if (Math.abs(dx) < speed && Math.abs(dy) < speed) {
        player.pixelX = player.targetX;
        player.pixelY = player.targetY;
        player.moving = false;
        checkCollision();
        update();
      } else {
        if (dx !== 0) player.pixelX += speed * Math.sign(dx);
        if (dy !== 0) player.pixelY += speed * Math.sign(dy);
        update();
        requestAnimationFrame(animatePlayer);
      }
    }

    const checkCollision = () => {
      for (let i = 0; i < items.length; i++) {
        let item = items[i];
        if (item.x === player.x && item.y === player.y) {
          if (item.type === 'dream') {
            alert("You reached your dream! üéâ");
            location.reload();
          } else if (item.type === 'temptation') {
            health--;
            alert("You gave in to temptation! -1 Health");
          } else if (item.type === 'work') {
            score += 10;
            alert("You worked hard and earned 10 points.");
          }
          items.splice(i, 1);
          break;
        }
      }

      if (health <= 0) {
        alert("Game Over. You lost all health.");
        location.reload();
      }
    };

    document.addEventListener('keydown', e => {
      if (player.moving) return; // Wait for animation to finish
      let newX = player.x;
      let newY = player.y;
      if (e.key === 'ArrowRight' && player.x < cols - 1) newX++;
      if (e.key === 'ArrowLeft' && player.x > 0) newX--;
      if (e.key === 'ArrowUp' && player.y > 0) newY--;
      if (e.key === 'ArrowDown' && player.y < rows - 1) newY++;

      if (newX !== player.x || newY !== player.y) {
        player.x = newX;
        player.y = newY;
        player.targetX = player.x * box;
        player.targetY = player.y * box;
        player.moving = true;
        animatePlayer();
      }
    });

    // Initialize pixel position
    player.pixelX = player.x * box;
    player.pixelY = player.y * box;
    player.targetX = player.pixelX;
    player.targetY = player.pixelY;

    spawnItems();
    update();
  </script>
</body>
</html>
